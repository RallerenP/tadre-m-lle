<!DOCTYPE html>
<html class="bg-default h-screen w-screen overflow-x-hidden" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tadre Mølle / opret</title>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link href="/css/custom.css" rel="stylesheet">
</head>
<body class="h-full w-full">
<div class="bg-white w-100 h-20 px-default flex flex-row">
    <h1 class="text-2xl font-bold flex items-center">Tadre Mølles Venner</h1>
    <div class="flex-grow"></div>
    <div class="flex items-center text-red-600">
        <a class="px-4 hover:underline" href="/">Home</a>
        <a class="px-4 hover:underline" href="/second-item">Second Item</a>
        <a class="px-4 hover:underline" href="/third-item">Third Item</a>
        <a class="px-4 hover:underline" href="/fourth-item">Fourth Item</a>
    </div>
</div>
<div class="bg-white w-full text-center text-4xl flex justify-center items-center h-32">
    Opret ny side
</div>
<div>
    <div class="w-full text-center text-4xl flex justify-center items-center">
        <label>Titel</label>
    </div>
    <div class="w-full text-center text-4xl flex justify-center items-center">
        <input class="w-96 border-solid border-4 border-light-blue-500" type="text" id="titel" name="titel">
    </div>
    <div class="w-full text-center text-4xl flex justify-center items-center">
        <label for="indhold">Indhold</label>
    </div>
    <div class="w-full text-center text-4xl flex justify-center items-center">
        <textarea class="h-48 w-96 border-solid border-4 border-light-blue-500" type="text" id="indhold"
                  name="indhold"></textarea>
    </div>
    <div class="w-full text-center text-4xl flex justify-center items-center">
        <button class="m-4" id="cancelButton">Annuller</button>
        <button class="m-4" id="submitButton">Opret</button>
    </div>
</div>

<script>
    $('#cancelButton').click(() => window.history.back());

    $("#submitButton").on("click", function () {
        const title = $("#titel").val();
        const content = $("#indhold").val();
        const url = urlConverter(title);

        const data = JSON.stringify({
            title: title,
            content: content,
            url: `${url}`
        })

        $.ajax({
            url: '/api/pages/',
            contentType: "application/json",
            method: 'POST',
            data: data,
            success: (data) => {
                window.location.href = `/artikel/${data.url}`
            }
        })

        function urlConverter(url) {
            let tmp = url.toLowerCase();
            tmp = tmp.replace(/æ/g, "ae")
            tmp = tmp.replace(/ø/g, "oe")
            tmp = tmp.replace(/å/g, "aa")
            return tmp.replace(/[\W_]+/g,"-");
        }
    });


</script>

</body>
</html>